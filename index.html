<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>„É™„Ç¢„É´„Çø„Ç§„É†„Ç≥„Éº„ÉâÂÖ±Êúâ„Ç®„Éá„Ç£„Çø - inazuma</title>
  <link rel="stylesheet" type="text/css" href="/css/common.css">
  <link href="https://fonts.googleapis.com/earlyaccess/roundedmplus1c.css" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
</head>
<body>
  <!-- FacebookShareButtonConfig -->
  <div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = 'https://connect.facebook.net/ja_JP/sdk.js#xfbml=1&version=v3.0&appId=1700876790028389&autoLogAppEvents=1';
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

  <!-- „Çπ„Éó„É©„ÉÉ„Ç∑„É•ÁîªÈù¢ -->
  <div id="splash_1" class="splash">
    <div id="splash_body_1" class="splash_body">
      <img src="/images/zap.png" alt="inazuma"><br>
      <h1>- inazuma -<br>„É™„Ç¢„É´„Çø„Ç§„É†„Ç≥„Éº„ÉâÂÖ±Êúâ„Ç®„Éá„Ç£„Çø</h1>
      <p class="about">„ÉÅ„Çß„Ç±„É© üëâ <a href="http://issys16.info">issy_s16.info</a></p>
      <p class="copyright">Copyright ¬© 2018 Shogo Ishikura All Rights Reserved.</p>
    </div>
  </div>
  <div id="splash_2" class="splash">
    <div id="splash_body_2" class="splash_body">
      <button>Create Room!</button>
      <p class="desc">„Ç®„Éá„Ç£„ÇøÁîªÈù¢„ÅÆURL„ÇíÂÖ±Êúâ„Åô„Çã„Åì„Å®„Åß„É´„Éº„É†„Å´ÊãõÂæÖ„Åß„Åç„Åæ„Åô„ÄÇ</p>
      <div id="sns">
        <div class="fb-share-button" data-href="http://inazuma.tech" data-layout="button_count" data-size="small" data-mobile-iframe="true"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Finazuma.tech%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">„Ç∑„Çß„Ç¢</a></div>
        <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-text="„É™„Ç¢„É´„Çø„Ç§„É†„Ç≥„Éº„ÉâÂÖ±Êúâ„Ç®„Éá„Ç£„Çø -inazuma-" data-url="http://inazuma.tech" data-lang="ja" data-dnt="true" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        <a href="http://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="standard-balloon" data-hatena-bookmark-lang="ja" title="„Åì„ÅÆ„Ç®„É≥„Éà„É™„Éº„Çí„ÅØ„Å¶„Å™„Éñ„ÉÉ„ÇØ„Éû„Éº„ÇØ„Å´ËøΩÂä†"><img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" alt="„Åì„ÅÆ„Ç®„É≥„Éà„É™„Éº„Çí„ÅØ„Å¶„Å™„Éñ„ÉÉ„ÇØ„Éû„Éº„ÇØ„Å´ËøΩÂä†" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
      </div>
      <p class="copyright">Copyright ¬© 2018 Shogo Ishikura All Rights Reserved.</p>
    </div>
  </div>

  <div id="main">
    <!-- „Ç®„Éá„Ç£„Çø„Ç®„É™„Ç¢ -->
    <div id="editor_left" class="editor"></div>
    <div id="editor_right" class="editor"></div>

    <!-- „Ç∑„É≥„Çø„ÉÉ„ÇØ„Çπ„Éè„Ç§„É©„Ç§„ÉàË®≠ÂÆö -->
    <div id="editor_left_language">
      <select id="editor_left_language_select" name="editor_left_language">
        <option value="abap">ABAP</option>
        <option value="abc">ABC</option>
        <option value="actionscript">ActionScript</option>
        <option value="ada">ADA</option>
        <option value="apache_conf">Apache Conf</option>
        <option value="asciidoc">AsciiDoc</option>
        <option value="asl">ASL</option>
        <option value="assembly_x86">Assembly x86</option>
        <option value="autohotkey">AutoHotKey</option>
        <option value="batchfile">BatchFile</option>
        <option value="bro">Bro</option>
        <option value="c_cpp">C and C++</option>
        <option value="c9search">C9Search</option>
        <option value="cirru">Cirru</option>
        <option value="clojure">Clojure</option>
        <option value="cobol">Cobol</option>
        <option value="coffee">CoffeeScript</option>
        <option value="coldfusion">ColdFusion</option>
        <option value="csharp">C#</option>
        <option value="csound_document">Csound Document</option>
        <option value="csound_orchestra">Csound</option>
        <option value="csound_score">Csound Score</option>
        <option value="css">CSS</option>
        <option value="curly">Curly</option>
        <option value="d">D</option>
        <option value="dart">Dart</option>
        <option value="diff">Diff</option>
        <option value="dockerfile">Dockerfile</option>
        <option value="dot">Dot</option>
        <option value="drools">Drools</option>
        <option value="edifact">Edifact</option>
        <option value="eiffel">Eiffel</option>
        <option value="ejs">EJS</option>
        <option value="elixir">Elixir</option>
        <option value="elm">Elm</option>
        <option value="erlang">Erlang</option>
        <option value="forth">Forth</option>
        <option value="fortran">Fortran</option>
        <option value="fsharp">FSharp</option>
        <option value="ftl">FreeMarker</option>
        <option value="gcode">Gcode</option>
        <option value="gherkin">Gherkin</option>
        <option value="gitignore">Gitignore</option>
        <option value="glsl">Glsl</option>
        <option value="gobstones">Gobstones</option>
        <option value="golang">Go</option>
        <option value="graphqlschema">GraphQLSchema</option>
        <option value="groovy">Groovy</option>
        <option value="haml">HAML</option>
        <option value="handlebars">Handlebars</option>
        <option value="haskell">Haskell</option>
        <option value="haskell_cabal">Haskell Cabal</option>
        <option value="haxe">haXe</option>
        <option value="hjson">Hjson</option>
        <option value="html">HTML</option>
        <option value="html_elixir">HTML (Elixir)</option>
        <option value="html_ruby">HTML (Ruby)</option>
        <option value="ini">INI</option>
        <option value="io">Io</option>
        <option value="jack">Jack</option>
        <option value="jade">Jade</option>
        <option value="java">Java</option>
        <option value="javascript" selected>JavaScript</option>
        <option value="json">JSON</option>
        <option value="jsoniq">JSONiq</option>
        <option value="jsp">JSP</option>
        <option value="jssm">JSSM</option>
        <option value="jsx">JSX</option>
        <option value="julia">Julia</option>
        <option value="kotlin">Kotlin</option>
        <option value="latex">LaTeX</option>
        <option value="less">LESS</option>
        <option value="liquid">Liquid</option>
        <option value="lisp">Lisp</option>
        <option value="livescript">LiveScript</option>
        <option value="logiql">LogiQL</option>
        <option value="lsl">LSL</option>
        <option value="lua">Lua</option>
        <option value="luapage">LuaPage</option>
        <option value="lucene">Lucene</option>
        <option value="makefile">Makefile</option>
        <option value="markdown">Markdown</option>
        <option value="mask">Mask</option>
        <option value="matlab">MATLAB</option>
        <option value="maze">Maze</option>
        <option value="mel">MEL</option>
        <option value="mixal">MIXAL</option>
        <option value="mushcode">MUSHCode</option>
        <option value="mysql">MySQL</option>
        <option value="nix">Nix</option>
        <option value="nsis">NSIS</option>
        <option value="objectivec">Objective-C</option>
        <option value="ocaml">OCaml</option>
        <option value="pascal">Pascal</option>
        <option value="perl">Perl</option>
        <option value="pgsql">pgSQL</option>
        <option value="php_laravel_blade">PHP (Blade Template)</option>
        <option value="php">PHP</option>
        <option value="puppet">Puppet</option>
        <option value="pig">Pig</option>
        <option value="powershell">Powershell</option>
        <option value="praat">Praat</option>
        <option value="prolog">Prolog</option>
        <option value="properties">Properties</option>
        <option value="protobuf">Protobuf</option>
        <option value="python">Python</option>
        <option value="r">R</option>
        <option value="razor">Razor</option>
        <option value="rdoc">RDoc</option>
        <option value="red">Red</option>
        <option value="rhtml">RHTML</option>
        <option value="rst">RST</option>
        <option value="ruby">Ruby</option>
        <option value="rust">Rust</option>
        <option value="sass">SASS</option>
        <option value="scad">SCAD</option>
        <option value="scala">Scala</option>
        <option value="scheme">Scheme</option>
        <option value="scss">SCSS</option>
        <option value="sh">SH</option>
        <option value="sjs">SJS</option>
        <option value="slim">Slim</option>
        <option value="smarty">Smarty</option>
        <option value="snippets">snippets</option>
        <option value="soy_template">Soy Template</option>
        <option value="space">Space</option>
        <option value="sql">SQL</option>
        <option value="sqlserver">SQLServer</option>
        <option value="stylus">Stylus</option>
        <option value="svg">SVG</option>
        <option value="swift">Swift</option>
        <option value="tcl">Tcl</option>
        <option value="terraform">Terraform</option>
        <option value="tex">Tex</option>
        <option value="text">Text</option>
        <option value="textile">Textile</option>
        <option value="toml">Toml</option>
        <option value="tsx">TSX</option>
        <option value="twig">Twig</option>
        <option value="typescript">Typescript</option>
        <option value="vala">Vala</option>
        <option value="vbscript">VBScript</option>
        <option value="velocity">Velocity</option>
        <option value="verilog">Verilog</option>
        <option value="vhdl">VHDL</option>
        <option value="wollok">Wollok</option>
        <option value="xml">XML</option>
        <option value="xquery">XQuery</option>
        <option value="yaml">YAML</option>
        <option value="django">Django</option>
      </select>
    </div>

    <div id="editor_right_language">
      <select id="editor_right_language_select" name="editor_right_language">
        <option value="abap">ABAP</option>
        <option value="abc">ABC</option>
        <option value="actionscript">ActionScript</option>
        <option value="ada">ADA</option>
        <option value="apache_conf">Apache Conf</option>
        <option value="asciidoc">AsciiDoc</option>
        <option value="asl">ASL</option>
        <option value="assembly_x86">Assembly x86</option>
        <option value="autohotkey">AutoHotKey</option>
        <option value="batchfile">BatchFile</option>
        <option value="bro">Bro</option>
        <option value="c_cpp">C and C++</option>
        <option value="c9search">C9Search</option>
        <option value="cirru">Cirru</option>
        <option value="clojure">Clojure</option>
        <option value="cobol">Cobol</option>
        <option value="coffee">CoffeeScript</option>
        <option value="coldfusion">ColdFusion</option>
        <option value="csharp">C#</option>
        <option value="csound_document">Csound Document</option>
        <option value="csound_orchestra">Csound</option>
        <option value="csound_score">Csound Score</option>
        <option value="css">CSS</option>
        <option value="curly">Curly</option>
        <option value="d">D</option>
        <option value="dart">Dart</option>
        <option value="diff">Diff</option>
        <option value="dockerfile">Dockerfile</option>
        <option value="dot">Dot</option>
        <option value="drools">Drools</option>
        <option value="edifact">Edifact</option>
        <option value="eiffel">Eiffel</option>
        <option value="ejs">EJS</option>
        <option value="elixir">Elixir</option>
        <option value="elm">Elm</option>
        <option value="erlang">Erlang</option>
        <option value="forth">Forth</option>
        <option value="fortran">Fortran</option>
        <option value="fsharp">FSharp</option>
        <option value="ftl">FreeMarker</option>
        <option value="gcode">Gcode</option>
        <option value="gherkin">Gherkin</option>
        <option value="gitignore">Gitignore</option>
        <option value="glsl">Glsl</option>
        <option value="gobstones">Gobstones</option>
        <option value="golang">Go</option>
        <option value="graphqlschema">GraphQLSchema</option>
        <option value="groovy">Groovy</option>
        <option value="haml">HAML</option>
        <option value="handlebars">Handlebars</option>
        <option value="haskell">Haskell</option>
        <option value="haskell_cabal">Haskell Cabal</option>
        <option value="haxe">haXe</option>
        <option value="hjson">Hjson</option>
        <option value="html">HTML</option>
        <option value="html_elixir">HTML (Elixir)</option>
        <option value="html_ruby">HTML (Ruby)</option>
        <option value="ini">INI</option>
        <option value="io">Io</option>
        <option value="jack">Jack</option>
        <option value="jade">Jade</option>
        <option value="java">Java</option>
        <option value="javascript" selected>JavaScript</option>
        <option value="json">JSON</option>
        <option value="jsoniq">JSONiq</option>
        <option value="jsp">JSP</option>
        <option value="jssm">JSSM</option>
        <option value="jsx">JSX</option>
        <option value="julia">Julia</option>
        <option value="kotlin">Kotlin</option>
        <option value="latex">LaTeX</option>
        <option value="less">LESS</option>
        <option value="liquid">Liquid</option>
        <option value="lisp">Lisp</option>
        <option value="livescript">LiveScript</option>
        <option value="logiql">LogiQL</option>
        <option value="lsl">LSL</option>
        <option value="lua">Lua</option>
        <option value="luapage">LuaPage</option>
        <option value="lucene">Lucene</option>
        <option value="makefile">Makefile</option>
        <option value="markdown">Markdown</option>
        <option value="mask">Mask</option>
        <option value="matlab">MATLAB</option>
        <option value="maze">Maze</option>
        <option value="mel">MEL</option>
        <option value="mixal">MIXAL</option>
        <option value="mushcode">MUSHCode</option>
        <option value="mysql">MySQL</option>
        <option value="nix">Nix</option>
        <option value="nsis">NSIS</option>
        <option value="objectivec">Objective-C</option>
        <option value="ocaml">OCaml</option>
        <option value="pascal">Pascal</option>
        <option value="perl">Perl</option>
        <option value="pgsql">pgSQL</option>
        <option value="php_laravel_blade">PHP (Blade Template)</option>
        <option value="php">PHP</option>
        <option value="puppet">Puppet</option>
        <option value="pig">Pig</option>
        <option value="powershell">Powershell</option>
        <option value="praat">Praat</option>
        <option value="prolog">Prolog</option>
        <option value="properties">Properties</option>
        <option value="protobuf">Protobuf</option>
        <option value="python">Python</option>
        <option value="r">R</option>
        <option value="razor">Razor</option>
        <option value="rdoc">RDoc</option>
        <option value="red">Red</option>
        <option value="rhtml">RHTML</option>
        <option value="rst">RST</option>
        <option value="ruby">Ruby</option>
        <option value="rust">Rust</option>
        <option value="sass">SASS</option>
        <option value="scad">SCAD</option>
        <option value="scala">Scala</option>
        <option value="scheme">Scheme</option>
        <option value="scss">SCSS</option>
        <option value="sh">SH</option>
        <option value="sjs">SJS</option>
        <option value="slim">Slim</option>
        <option value="smarty">Smarty</option>
        <option value="snippets">snippets</option>
        <option value="soy_template">Soy Template</option>
        <option value="space">Space</option>
        <option value="sql">SQL</option>
        <option value="sqlserver">SQLServer</option>
        <option value="stylus">Stylus</option>
        <option value="svg">SVG</option>
        <option value="swift">Swift</option>
        <option value="tcl">Tcl</option>
        <option value="terraform">Terraform</option>
        <option value="tex">Tex</option>
        <option value="text">Text</option>
        <option value="textile">Textile</option>
        <option value="toml">Toml</option>
        <option value="tsx">TSX</option>
        <option value="twig">Twig</option>
        <option value="typescript">Typescript</option>
        <option value="vala">Vala</option>
        <option value="vbscript">VBScript</option>
        <option value="velocity">Velocity</option>
        <option value="verilog">Verilog</option>
        <option value="vhdl">VHDL</option>
        <option value="wollok">Wollok</option>
        <option value="xml">XML</option>
        <option value="xquery">XQuery</option>
        <option value="yaml">YAML</option>
        <option value="django">Django</option>
      </select>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> 
  <script src='/socket.io/socket.io.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.3.3/ace.js"></script>
  <script>
    var roomName;

    $(function(){
      main();
    });

    // Main
    function main(){
      roomName = location.pathname.slice(1);

      if (roomName){
        setTimeout(function(){
          $("#splash_1").fadeOut("slow");
          $("#splash_2").hide();
          initEditor();
        }, 2000);
      } else {
        setTimeout(function(){
          $("#splash_1").fadeOut("slow");
        }, 2000);
      }
    }

    // InitEditor
    function initEditor() {
      var editor_left = ace.edit("editor_left");
      editor_left.setTheme("ace/theme/monokai");
      editor_left.session.setMode("ace/mode/javascript");
      editor_left.setFontSize(14);

      var editor_right = ace.edit("editor_right");
      editor_right.setTheme("ace/theme/monokai");
      editor_right.session.setMode("ace/mode/javascript");
      editor_right.setFontSize(14);

      var socket = io.connect();

      socket.json.emit('connect_room_from_client', {
        room: roomName
      });

      socket.on('init_left_from_server', function(data){
        flg = false;
        editor_left.setValue(data);
        editor_left.gotoLine(0,0);
        flg = true;
      });

      socket.on('init_right_from_server', function(data){
        flg = false;
        editor_right.setValue(data);
        editor_right.gotoLine(0,0);
        flg = true;
      });
      
      var flg = true;
      editor_left.on('change', function(e){
        if(flg){
          socket.json.emit('emit_left_from_client', {
            room: roomName,
            body: editor_left.getValue(),
            cursor: editor_left.selection.getCursor()
          });
        }
      });

      socket.on('emit_left_from_server', function(data){
        flg = false;
        editor_left.setValue(data.body);
        editor_left.gotoLine(data.cursor.row + 1, data.cursor.column + 1);
        flg = true;
      });

      editor_right.on('change', function(e){
        if(flg){
          socket.json.emit('emit_right_from_client', {
            room: roomName,
            body: editor_right.getValue(),
            cursor: editor_right.selection.getCursor()
          });
        }
      });

      socket.on('emit_right_from_server', function(data){
        flg = false;
        editor_right.setValue(data.body);
        editor_right.gotoLine(data.cursor.row + 1, data.cursor.column + 1);
        flg = true;
      });

      $("#editor_left_language_select").on("change", function(e){
        editor_left.session.setMode("ace/mode/" + $("#editor_left_language_select").val());
      });
  
      $("#editor_right_language_select").on("change", function(e){
        editor_right.session.setMode("ace/mode/" + $("#editor_right_language_select").val());
      });
    }

    // EventListener
    $(function(){
      $("#splash_2 button").on("click", function(){
        $("#splash_2").fadeOut("fast");
        roomName = Math.random().toString(36).slice(-8);
        history.replaceState('','', roomName);
        initEditor();
      });
    })
  </script>
</body>
</html>
